version: 2.1

jobs:
  build:
    docker:
      - image: yzouad/ubuntu_18.04_yocto:v1
        environment:
          LC_ALL: en_US.UTF-8
          LANG: en_US.UTF-8
          LANGUAGE: en_US.UTF-8
    steps:
      - checkout
      - run:
          name: Clone ces-bsp-platform
          command: |
                git config --global user.email "yzouad@yzouad.com"
                git config --global user.name "yzouad"
                mkdir /home/builder/ces-bsp-platform
                cd /home/builder/ces-bsp-platform
                repo init -u https://github.com/software-celo/ces-bsp-platform -b warrior
                repo sync
      - run:
          name: Build ces-qt-demoimage (pixi-cdl100)
          command: |
                MACHINE=pixi-cdl100
                DISTRO=ces-fb
                source /home/builder/ces-bsp-platform/setup-environment build <<< "y"
                bitbake ces-qt-demoimage

      - run:
          name: Build ces-qt-demoimage (crix-cql100)
          command: |
                MACHINE=crix-cq100 
                DISTRO=ces-fb
                source /home/builder/ces-bsp-platform/setup-environment build <<< "y"
                bitbake ces-qt-demoimage


workflows:
  workflow:
    jobs:
      - build
